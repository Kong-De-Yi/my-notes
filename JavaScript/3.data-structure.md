# 原始类型的方法

## 需求：使用方法对原始类型执行操作

- 解决方案：对象包装器（String、Number、Boolean、Symbol、Bigint）
- 实现原理：访问原始值的属性时，创建对象包装器对象，访问结束就销毁

```javascript
let str = "hello";
alert(str.toUpperCase()); //HELLO

let n = 1.23456;
alert(n.toFixed(2)); //1.23
```

- 构造器 String/Number/Boolean 仅供内部使用

```javascript
alert(typeof 0); //"number"
alert(typeof new Number(0)); //"object"

let zero = new Number(0);
if (zero) {
  //zero是对象，始终为true
  alert("zero is truthy?!?");
}
```

- 调用不带"new"的 String/Number/Boolean 有效

```javascript
let num = Number("123"); //将字符串转换为数字
```

- null 和 undefined 没有对象包装器，也没有任何方法

# 数字类型

- Number：双精度浮点数（64 位 IEEE-754 格式），范围 ±($2^{53}$-1)
- Bigint：任意长度的整数

## 数字的更多写法

```javascript
let billion = 1000000000;
let billion = 1_000_000_000; //更具可读性的写法，_会被javascript引擎忽略

//e后面的正数表示乘以1后面跟着指定数量的0的数字
1e3 === 1 * 1000; //e3表示*1000
1.23e6 === 1.23 * 1000000; //e6表示*1000000

//e后面的负数表示除以1后面跟着指定数量的0的数字
1e-3 === 1 / 1000; //e-3表示/1000
1.23e-6 === 1.23 / 1000000; //e-6表示/1000000
1234e-2 === 1234 / 100; //e-2表示/100
```

## 不同的进制

- 十六进制：`0xff`、`0xFF`(255)
- 二进制：`0b11111111`(255)
- 八进制：`0o377`(255)
- `toString(base)`：
  - 返回 base 进制中的字符串表示形式
  - base 取值范围 2-36，默认 10

```javascript
let num = 255;
alert(num.toString(16)); //ff
alert(num.toString(2)); //11111111
```

- 使用两个点来调用方法(或者括号)：
  `let num = 123456789..toString(36); //'21i3v9'`
  `let num = (123456789).toString(36); //'21i3v9'`

## 数字的舍入

- 舍入到整数
  - Math.floor：向下舍入，3.1 —> 3,-1.1 —> -2
  - Math.ceil：向上输入，3.1 —> 4,-1.1 —> -1
  - Math.round：向最接近的整数舍入，3.1 —> 3,3.6 —> 4，3.5 —> 4
  - Math.trunc：截断取整，3.1 —> 3,-1.1 —> -1
- 舍入到小数点后 n 位
  - 乘除法
  - toFixed(n)：将数字舍入到小数点后 n 位，并返回字符串形式，向最接近的值输入，类似 Math.round

```javascript
let num = 1.23456;
alert(Math.round(num * 100) / 100); //1.23456—>123.456—>123—>1.23

let num = 12.36;
alert(num.toFixed(1)); //"12.4"
alert(num.toFixed(5)); //"12.36000"，在末尾添加0
```

## 不精确的计算

- 64 位格式存储 —> 数据溢出`alert(1e500);//Infinity`
- 二进制下无限循环小数 —> 精度损失

```javascript
alert(0.1 + 0.2 == 0.3); //fasle
alert(0.1 + 0.2); //0.30000000000000004
alert((0.1).toFixed(20)); //0.10000000000000000555
```

- 解决办法：`toFixed(n)`,返回 string

```javascript
let sum = 0.1 + 0.2;
alert(sum.toFixed(2)); //"0.30"
alert(+sum.toFixed(2)); //0.3
```

- 乘除法可以减少误差，不能完全消除误差

## 测试：isFinite 和 isNaN

- `isNaN(value)`：将 value 转化为数字后测试是否为 NaN（===NaN 始终返回 false，无法测试）

```javascript
alert(isNaN(NaN)); //true
alert(isNaN("str")); //true
alert(NaN === NaN); //false
```

- `isFinite(value)`：将 value 转化为数字后测试是否为$ \pm $ Infinity 或 NaN，否则返回 true

```javascript
alert(isFinite("15")); //true
alert(isFinite("str")); //false,转化结果为NaN
alert(isFinite(Infinity)); //fasle

//验证输入值是否为常规数字
let num = +prompt("Enter a number", "");
alert(isFinite(num)); //
```

- `Object.is(a,b)`：类似 ===，边缘情况更可靠
  - `Object.is(NaN,NaN) === true`
  - `Object.is(+0,-0) === false`
  - 其他情况`Object.is(a,b)`与`a === b`相同

## 智能提取数字（parseInt 和 parseFloat）

- 从字符串中读取数字，直到无法读取为止

```javascript
alert(parseInt("100px")); //100
alert(parseInt("12.3")); //12，只返回整数

alert(parseFloat("12.5em")); //12.5
alert(parseFloat("12.3.4")); //12.3,第二个点处停止了读取

alert(parseInt("a123")); //NaN,第一个符号停止了读取
```

- `parseInt(str,[radix])`:radix 可选，指定数制解析多进制下的字符串

```javascript
alert(parseInt("0xff", 16)); //255
alert(parseInt("ff"), 16); //255，没有0x依然有效
alert(parseInt("2n9c", 36)); //123456
```

## 内建对象：Math

- `Math.random()`:返回[0.0,1.0)范围的随机数
- `Math.max(arg1,arg2,...,argN)`和`Math.min(arg1,arg2,...,argN)`：返回最大值和最小值
- `Math.pow(n,power)`：返回 n 的 power 次幂

# 字符串

- 单个字符没有特有的类型
- 内部编码：UTF-16

## 转义字符

- \n —> 换行
- \\' —> 单引号
- \\\" —> 双引号
- \\\ —> 反斜线
- \xXX —> 十六进制 Unicode 码的对应字符，"\x7A" —> "z"
- \uXXXX —> 十六进制 UTF-16 编码的对应 Unicode 字符，"\u00A9" —> "©"
- \u{X...XXX} —> 十六进制 UTF-32 编码的对应 Unicode 字符
- 只有与外部闭合引号相同的引号才需要转义

```javascript
let str = `I'm the Walrus!`; //I'm the Walrus!
let str = "I'm the Walrus!"; //I'm the Walrus!
let str = `The backslash：\\`; //The backslash：\
```

## 字符串长度：属性`length`

```javascript
alert(`My\n`.length); //3
```

## 访问字符串中的字符

- 第一个字符位置：0
- `str[pos]`：返回 pos 位置的字符，没有返回 undefined
- `str.charAt(pos)`：返回 pos 位置的字符，没有返回空字符串

```javascript
let str = `Hello`;
alert(str[0]); //H
alert(str.charAt(0)); //H
alert(str[str.length - 1]); //返回最后一个字符
alert(str[1000]); //undefined
alart(str.charAt(1000)); //""
```

- 遍历字符：for...of

```javascript
for (let char of "Hello") {
  alert(char); //H,e,l,l,o
}
```
